<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1">--><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Linux Centos GitæœåŠ¡å™¨æ­å»º | å°_å±®ã€çš„åšå®¢æ—¥è®°</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Linux Centos GitæœåŠ¡å™¨æ­å»º" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="æ–‡ç« æ¥æºï¼š https://www.runoob.com/git/git-server.html 1ã€å®‰è£…Git[rootç”¨æˆ·] yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-devel yum install git åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š groupadd git useradd git -g git passwd git //è®¾ç½®å¯†ç  2ã€åˆ›å»ºè¯ä¹¦ç™»å½•[rootç”¨æˆ·] å°†æˆ‘ä»¬çš„å…¬é’¥å¯¼å…¥åˆ°/home/git/.ssh/authorized_keysæ–‡ä»¶é‡Œï¼Œä¸€è¡Œä¸€ä¸ªã€‚ å…¬é’¥ä½äºæœ¬åœ°çš„C:\Users\ç”¨æˆ·å\ .ssh\id_rsa.pubæ–‡ä»¶ cd /home/git/ mkdir .ssh chmod 755 .ssh touch .ssh/authorized_keys chmod 644 .ssh/authorized_keys chown git:git .ssh/ 3ã€åˆå§‹åŒ–Gitä»“åº“[rootç”¨æˆ·] é¦–å…ˆæˆ‘ä»¬é€‰å®šä¸€ä¸ªç›®å½•ä½œä¸ºGitä»“åº“ï¼Œå‡å®šæ˜¯/usr/local/gitRepo/demo.gitï¼Œåœ¨/usr/local/gitRepoç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ï¼š cd /usr/local mkdir gitRepo chown git:git gitRepo/ cd gitRepo git init --bare demo.git //Initialized empty Git repository in /usr/local/gitRepo/demo.git/ ä»¥ä¸Šå‘½ä»¤Gitåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ï¼ŒæœåŠ¡å™¨ä¸Šçš„Gitä»“åº“é€šå¸¸éƒ½ä»¥.gitç»“å°¾ã€‚ç„¶åï¼ŒæŠŠä»“åº“æ‰€å±ç”¨æˆ·æ”¹ä¸ºgitï¼š chown -R git:git demo.git 4ã€å…‹éš†ä»“åº“[Gitç”¨æˆ·] git clone git@127.0.0.1:/usr/local/gitRepo/demo.git Cloning into &#39;runoob&#39;... warning: You appear to have cloned an empty repository. Checking connectivity... done. 192.168.45.4 ä¸º Git æ‰€åœ¨æœåŠ¡å™¨ ip ï¼Œä½ éœ€è¦å°†å…¶ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ Git æœåŠ¡ ipã€‚ è¿™æ ·æˆ‘ä»¬çš„ Git æœåŠ¡å™¨å®‰è£…å°±å®Œæˆã€‚ 5ã€æ•´ç‚¹å¥½ç©çš„ gitä»“åº“è§¦å‘æäº¤[Gitç”¨æˆ·] ä¿®æ”¹äº‘ç«¯ä»“åº“hooksä¸­çš„post-receiveå‡½æ•° cd /usr/local/gitRepo/demo.git/hooks vim post-receive #!/bin/sh read local_ref local_sha remote_ref remote_sha DIR=`pwd` DIR=${DIR%.*} branch=${remote_ref##*/} cd ${DIR} unset GIT_DIR echo &quot;${branch}å¼€å§‹æ‹‰å–ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹`pwd`&quot; chmod 755 restart-demo.sh ./restart-demo.sh ${branch} chmod 755 post-receive æœåŠ¡å™¨æ‹‰å–é¡¹ç›® mkdir /usr/local/gitRepo/demo cd /usr/local/gitRepo/ git init demo cd demo git config --local user.name &quot;xc&quot; git config --local user.email &#39;1960481101@qq.com&#39; ssh-keygen -t rsa æ‰¾åˆ°ç”Ÿæˆçš„æ–‡ä»¶çš„å…¬é’¥/home/git/.ssh/id_rsa.pubï¼Œæ·»åŠ åˆ° /home/git/.ssh/authorized_keys,ç„¶åå…‹éš†é¡¹ç›® cd /usr/local/gitRepo/demo git remote add origin git@127.0.0.1:/usr/local/gitRepo/demo.git git pull é¡¹ç›®ä¸­åˆ›å»ºè„šæœ¬ restart-demo.sh è„šæœ¬åœ¨é¡¹ç›®æœ€å¤–ä¾§ï¼Œæ–¹ä¾¿,mvnä½ç½®è‡ªå·±æ”¹ #! /bin/bash date updateBranch=master branch=$1 if [ &quot;$branch&quot; ! = &quot;$updateBranch&quot; ]; then echo &quot;åˆ†æ”¯ä¸º${updateBranch}æ‰è¿›è¡Œæ›´æ–°&quot; exit 1 fi repoPath=$(pwd) profile=$branch cd $repoPath git reset --hard origin/$branch git checkout -f -b cache origin/$branch git branch -D $branch git checkout -f -b $branch origin/$branch git branch -D cache git pull --no-edit /usr/local/custom/maven/bin/mvn clean package -P$profile cd target file=$(ls *.jar | awk &#39;{print $1}&#39;) sp_pid=$(ps -ef | grep $file | grep -v grep | awk &#39;{print $2}&#39;) if [ -z &quot;$sp_pid&quot; ]; then echo &quot;[ not find sp-tomcat pid ]&quot; else echo &quot;find result: $sp_pid &quot; kill -9 $sp_pid fi logPath=$repoPath/${file%.*}.out nohup java -jar $file &gt;$logPath 2&gt;&amp;1 &amp; echo &quot;--å¯åŠ¨ok,æ—¥å¿—è§$logPath--&quot; å°†é¡¹ç›®ä»£ç æ–‡ä»¶å¤¹å…¶æ‹¥æœ‰è€…è®¾ç½®ä¸ºgit æ³¨æ„ï¼Œé¡¹ç›®ä¸­æ‰€æœ‰è¾“å‡ºè·¯å¾„éƒ½éœ€è¦ç”¨æˆ·gitæœ‰æ“ä½œæƒé™" />
<meta property="og:description" content="æ–‡ç« æ¥æºï¼š https://www.runoob.com/git/git-server.html 1ã€å®‰è£…Git[rootç”¨æˆ·] yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-devel yum install git åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š groupadd git useradd git -g git passwd git //è®¾ç½®å¯†ç  2ã€åˆ›å»ºè¯ä¹¦ç™»å½•[rootç”¨æˆ·] å°†æˆ‘ä»¬çš„å…¬é’¥å¯¼å…¥åˆ°/home/git/.ssh/authorized_keysæ–‡ä»¶é‡Œï¼Œä¸€è¡Œä¸€ä¸ªã€‚ å…¬é’¥ä½äºæœ¬åœ°çš„C:\Users\ç”¨æˆ·å\ .ssh\id_rsa.pubæ–‡ä»¶ cd /home/git/ mkdir .ssh chmod 755 .ssh touch .ssh/authorized_keys chmod 644 .ssh/authorized_keys chown git:git .ssh/ 3ã€åˆå§‹åŒ–Gitä»“åº“[rootç”¨æˆ·] é¦–å…ˆæˆ‘ä»¬é€‰å®šä¸€ä¸ªç›®å½•ä½œä¸ºGitä»“åº“ï¼Œå‡å®šæ˜¯/usr/local/gitRepo/demo.gitï¼Œåœ¨/usr/local/gitRepoç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ï¼š cd /usr/local mkdir gitRepo chown git:git gitRepo/ cd gitRepo git init --bare demo.git //Initialized empty Git repository in /usr/local/gitRepo/demo.git/ ä»¥ä¸Šå‘½ä»¤Gitåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ï¼ŒæœåŠ¡å™¨ä¸Šçš„Gitä»“åº“é€šå¸¸éƒ½ä»¥.gitç»“å°¾ã€‚ç„¶åï¼ŒæŠŠä»“åº“æ‰€å±ç”¨æˆ·æ”¹ä¸ºgitï¼š chown -R git:git demo.git 4ã€å…‹éš†ä»“åº“[Gitç”¨æˆ·] git clone git@127.0.0.1:/usr/local/gitRepo/demo.git Cloning into &#39;runoob&#39;... warning: You appear to have cloned an empty repository. Checking connectivity... done. 192.168.45.4 ä¸º Git æ‰€åœ¨æœåŠ¡å™¨ ip ï¼Œä½ éœ€è¦å°†å…¶ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ Git æœåŠ¡ ipã€‚ è¿™æ ·æˆ‘ä»¬çš„ Git æœåŠ¡å™¨å®‰è£…å°±å®Œæˆã€‚ 5ã€æ•´ç‚¹å¥½ç©çš„ gitä»“åº“è§¦å‘æäº¤[Gitç”¨æˆ·] ä¿®æ”¹äº‘ç«¯ä»“åº“hooksä¸­çš„post-receiveå‡½æ•° cd /usr/local/gitRepo/demo.git/hooks vim post-receive #!/bin/sh read local_ref local_sha remote_ref remote_sha DIR=`pwd` DIR=${DIR%.*} branch=${remote_ref##*/} cd ${DIR} unset GIT_DIR echo &quot;${branch}å¼€å§‹æ‹‰å–ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹`pwd`&quot; chmod 755 restart-demo.sh ./restart-demo.sh ${branch} chmod 755 post-receive æœåŠ¡å™¨æ‹‰å–é¡¹ç›® mkdir /usr/local/gitRepo/demo cd /usr/local/gitRepo/ git init demo cd demo git config --local user.name &quot;xc&quot; git config --local user.email &#39;1960481101@qq.com&#39; ssh-keygen -t rsa æ‰¾åˆ°ç”Ÿæˆçš„æ–‡ä»¶çš„å…¬é’¥/home/git/.ssh/id_rsa.pubï¼Œæ·»åŠ åˆ° /home/git/.ssh/authorized_keys,ç„¶åå…‹éš†é¡¹ç›® cd /usr/local/gitRepo/demo git remote add origin git@127.0.0.1:/usr/local/gitRepo/demo.git git pull é¡¹ç›®ä¸­åˆ›å»ºè„šæœ¬ restart-demo.sh è„šæœ¬åœ¨é¡¹ç›®æœ€å¤–ä¾§ï¼Œæ–¹ä¾¿,mvnä½ç½®è‡ªå·±æ”¹ #! /bin/bash date updateBranch=master branch=$1 if [ &quot;$branch&quot; ! = &quot;$updateBranch&quot; ]; then echo &quot;åˆ†æ”¯ä¸º${updateBranch}æ‰è¿›è¡Œæ›´æ–°&quot; exit 1 fi repoPath=$(pwd) profile=$branch cd $repoPath git reset --hard origin/$branch git checkout -f -b cache origin/$branch git branch -D $branch git checkout -f -b $branch origin/$branch git branch -D cache git pull --no-edit /usr/local/custom/maven/bin/mvn clean package -P$profile cd target file=$(ls *.jar | awk &#39;{print $1}&#39;) sp_pid=$(ps -ef | grep $file | grep -v grep | awk &#39;{print $2}&#39;) if [ -z &quot;$sp_pid&quot; ]; then echo &quot;[ not find sp-tomcat pid ]&quot; else echo &quot;find result: $sp_pid &quot; kill -9 $sp_pid fi logPath=$repoPath/${file%.*}.out nohup java -jar $file &gt;$logPath 2&gt;&amp;1 &amp; echo &quot;--å¯åŠ¨ok,æ—¥å¿—è§$logPath--&quot; å°†é¡¹ç›®ä»£ç æ–‡ä»¶å¤¹å…¶æ‹¥æœ‰è€…è®¾ç½®ä¸ºgit æ³¨æ„ï¼Œé¡¹ç›®ä¸­æ‰€æœ‰è¾“å‡ºè·¯å¾„éƒ½éœ€è¦ç”¨æˆ·gitæœ‰æ“ä½œæƒé™" />
<link rel="canonical" href="http://localhost:4000/2022/10/14/Linux-CentOS-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html" />
<meta property="og:url" content="http://localhost:4000/2022/10/14/Linux-CentOS-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html" />
<meta property="og:site_name" content="å°_å±®ã€çš„åšå®¢æ—¥è®°" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-14T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Linux Centos GitæœåŠ¡å™¨æ­å»º" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-14T00:00:00+08:00","datePublished":"2022-10-14T00:00:00+08:00","description":"æ–‡ç« æ¥æºï¼š https://www.runoob.com/git/git-server.html 1ã€å®‰è£…Git[rootç”¨æˆ·] yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-devel yum install git åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š groupadd git useradd git -g git passwd git //è®¾ç½®å¯†ç  2ã€åˆ›å»ºè¯ä¹¦ç™»å½•[rootç”¨æˆ·] å°†æˆ‘ä»¬çš„å…¬é’¥å¯¼å…¥åˆ°/home/git/.ssh/authorized_keysæ–‡ä»¶é‡Œï¼Œä¸€è¡Œä¸€ä¸ªã€‚ å…¬é’¥ä½äºæœ¬åœ°çš„C:\\Users\\ç”¨æˆ·å\\ .ssh\\id_rsa.pubæ–‡ä»¶ cd /home/git/ mkdir .ssh chmod 755 .ssh touch .ssh/authorized_keys chmod 644 .ssh/authorized_keys chown git:git .ssh/ 3ã€åˆå§‹åŒ–Gitä»“åº“[rootç”¨æˆ·] é¦–å…ˆæˆ‘ä»¬é€‰å®šä¸€ä¸ªç›®å½•ä½œä¸ºGitä»“åº“ï¼Œå‡å®šæ˜¯/usr/local/gitRepo/demo.gitï¼Œåœ¨/usr/local/gitRepoç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ï¼š cd /usr/local mkdir gitRepo chown git:git gitRepo/ cd gitRepo git init --bare demo.git //Initialized empty Git repository in /usr/local/gitRepo/demo.git/ ä»¥ä¸Šå‘½ä»¤Gitåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ï¼ŒæœåŠ¡å™¨ä¸Šçš„Gitä»“åº“é€šå¸¸éƒ½ä»¥.gitç»“å°¾ã€‚ç„¶åï¼ŒæŠŠä»“åº“æ‰€å±ç”¨æˆ·æ”¹ä¸ºgitï¼š chown -R git:git demo.git 4ã€å…‹éš†ä»“åº“[Gitç”¨æˆ·] git clone git@127.0.0.1:/usr/local/gitRepo/demo.git Cloning into &#39;runoob&#39;... warning: You appear to have cloned an empty repository. Checking connectivity... done. 192.168.45.4 ä¸º Git æ‰€åœ¨æœåŠ¡å™¨ ip ï¼Œä½ éœ€è¦å°†å…¶ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ Git æœåŠ¡ ipã€‚ è¿™æ ·æˆ‘ä»¬çš„ Git æœåŠ¡å™¨å®‰è£…å°±å®Œæˆã€‚ 5ã€æ•´ç‚¹å¥½ç©çš„ gitä»“åº“è§¦å‘æäº¤[Gitç”¨æˆ·] ä¿®æ”¹äº‘ç«¯ä»“åº“hooksä¸­çš„post-receiveå‡½æ•° cd /usr/local/gitRepo/demo.git/hooks vim post-receive #!/bin/sh read local_ref local_sha remote_ref remote_sha DIR=`pwd` DIR=${DIR%.*} branch=${remote_ref##*/} cd ${DIR} unset GIT_DIR echo &quot;${branch}å¼€å§‹æ‹‰å–ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹`pwd`&quot; chmod 755 restart-demo.sh ./restart-demo.sh ${branch} chmod 755 post-receive æœåŠ¡å™¨æ‹‰å–é¡¹ç›® mkdir /usr/local/gitRepo/demo cd /usr/local/gitRepo/ git init demo cd demo git config --local user.name &quot;xc&quot; git config --local user.email &#39;1960481101@qq.com&#39; ssh-keygen -t rsa æ‰¾åˆ°ç”Ÿæˆçš„æ–‡ä»¶çš„å…¬é’¥/home/git/.ssh/id_rsa.pubï¼Œæ·»åŠ åˆ° /home/git/.ssh/authorized_keys,ç„¶åå…‹éš†é¡¹ç›® cd /usr/local/gitRepo/demo git remote add origin git@127.0.0.1:/usr/local/gitRepo/demo.git git pull é¡¹ç›®ä¸­åˆ›å»ºè„šæœ¬ restart-demo.sh è„šæœ¬åœ¨é¡¹ç›®æœ€å¤–ä¾§ï¼Œæ–¹ä¾¿,mvnä½ç½®è‡ªå·±æ”¹ #! /bin/bash date updateBranch=master branch=$1 if [ &quot;$branch&quot; ! = &quot;$updateBranch&quot; ]; then echo &quot;åˆ†æ”¯ä¸º${updateBranch}æ‰è¿›è¡Œæ›´æ–°&quot; exit 1 fi repoPath=$(pwd) profile=$branch cd $repoPath git reset --hard origin/$branch git checkout -f -b cache origin/$branch git branch -D $branch git checkout -f -b $branch origin/$branch git branch -D cache git pull --no-edit /usr/local/custom/maven/bin/mvn clean package -P$profile cd target file=$(ls *.jar | awk &#39;{print $1}&#39;) sp_pid=$(ps -ef | grep $file | grep -v grep | awk &#39;{print $2}&#39;) if [ -z &quot;$sp_pid&quot; ]; then echo &quot;[ not find sp-tomcat pid ]&quot; else echo &quot;find result: $sp_pid &quot; kill -9 $sp_pid fi logPath=$repoPath/${file%.*}.out nohup java -jar $file &gt;$logPath 2&gt;&amp;1 &amp; echo &quot;--å¯åŠ¨ok,æ—¥å¿—è§$logPath--&quot; å°†é¡¹ç›®ä»£ç æ–‡ä»¶å¤¹å…¶æ‹¥æœ‰è€…è®¾ç½®ä¸ºgit æ³¨æ„ï¼Œé¡¹ç›®ä¸­æ‰€æœ‰è¾“å‡ºè·¯å¾„éƒ½éœ€è¦ç”¨æˆ·gitæœ‰æ“ä½œæƒé™","headline":"Linux Centos GitæœåŠ¡å™¨æ­å»º","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/10/14/Linux-CentOS-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html"},"url":"http://localhost:4000/2022/10/14/Linux-CentOS-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="å°_å±®ã€çš„åšå®¢æ—¥è®°" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">å°_å±®ã€çš„åšå®¢æ—¥è®°</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="https://jekyllrb.com/" target="_blank">è‡ªå·±æ•´ä¸ªğŸ¤©</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Linux Centos GitæœåŠ¡å™¨æ­å»º</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-10-14T00:00:00+08:00" itemprop="datePublished">2022å¹´10æœˆ14æ—¥
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">å°_å±®ã€</span></span></p><span class="tag-type">#è¿ç»´</span><span class="tag-type">#linux</span><span class="tag-type">#CentOS</span><span class="tag-type">#git</span><span class="tag-type">#gitæœåŠ¡å™¨</span><span class="tag-type">#è‡ªåŠ¨éƒ¨ç½²</span></header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>æ–‡ç« æ¥æºï¼š https://www.runoob.com/git/git-server.html</p>

<h2 id="1å®‰è£…gitrootç”¨æˆ·">1ã€å®‰è£…Git[rootç”¨æˆ·]</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-devel
yum install git
</code></pre></div></div>

<p>åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groupadd git
useradd git -g git
passwd git
//è®¾ç½®å¯†ç 
</code></pre></div></div>

<h2 id="2åˆ›å»ºè¯ä¹¦ç™»å½•rootç”¨æˆ·">2ã€åˆ›å»ºè¯ä¹¦ç™»å½•[rootç”¨æˆ·]</h2>

<p>å°†æˆ‘ä»¬çš„å…¬é’¥å¯¼å…¥åˆ°/home/git/.ssh/authorized_keysæ–‡ä»¶é‡Œï¼Œä¸€è¡Œä¸€ä¸ªã€‚</p>

<p>å…¬é’¥ä½äºæœ¬åœ°çš„C:\Users\ç”¨æˆ·å\ .ssh\id_rsa.pubæ–‡ä»¶</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /home/git/
mkdir .ssh
chmod 755 .ssh
touch .ssh/authorized_keys
chmod 644 .ssh/authorized_keys
chown git:git .ssh/
</code></pre></div></div>

<h2 id="3åˆå§‹åŒ–gitä»“åº“rootç”¨æˆ·">3ã€åˆå§‹åŒ–Gitä»“åº“[rootç”¨æˆ·]</h2>

<p>é¦–å…ˆæˆ‘ä»¬é€‰å®šä¸€ä¸ªç›®å½•ä½œä¸ºGitä»“åº“ï¼Œå‡å®šæ˜¯/usr/local/gitRepo/demo.gitï¼Œåœ¨/usr/local/gitRepoç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /usr/local
mkdir gitRepo
chown git:git gitRepo/
cd gitRepo

git init --bare demo.git

//Initialized empty Git repository in /usr/local/gitRepo/demo.git/
</code></pre></div></div>

<p>ä»¥ä¸Šå‘½ä»¤Gitåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ï¼ŒæœåŠ¡å™¨ä¸Šçš„Gitä»“åº“é€šå¸¸éƒ½ä»¥.gitç»“å°¾ã€‚ç„¶åï¼ŒæŠŠä»“åº“æ‰€å±ç”¨æˆ·æ”¹ä¸ºgitï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chown -R git:git demo.git
</code></pre></div></div>

<h2 id="4å…‹éš†ä»“åº“gitç”¨æˆ·">4ã€å…‹éš†ä»“åº“[Gitç”¨æˆ·]</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@127.0.0.1:/usr/local/gitRepo/demo.git

Cloning into 'runoob'...
warning: You appear to have cloned an empty repository.
Checking connectivity... done.
</code></pre></div></div>

<p>192.168.45.4 ä¸º Git æ‰€åœ¨æœåŠ¡å™¨ ip ï¼Œä½ éœ€è¦å°†å…¶ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ Git æœåŠ¡ ipã€‚</p>

<p>è¿™æ ·æˆ‘ä»¬çš„ Git æœåŠ¡å™¨å®‰è£…å°±å®Œæˆã€‚</p>

<h2 id="5æ•´ç‚¹å¥½ç©çš„--gitä»“åº“è§¦å‘æäº¤gitç”¨æˆ·">5ã€æ•´ç‚¹å¥½ç©çš„  gitä»“åº“è§¦å‘æäº¤[Gitç”¨æˆ·]</h2>

<p>ä¿®æ”¹äº‘ç«¯ä»“åº“hooksä¸­çš„post-receiveå‡½æ•°</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /usr/local/gitRepo/demo.git/hooks
vim post-receive
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/bin/sh
read local_ref local_sha remote_ref remote_sha
DIR=`pwd`
DIR=${DIR%.*}
branch=${remote_ref##*/}
cd ${DIR}
unset GIT_DIR
echo "${branch}å¼€å§‹æ‹‰å–ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹`pwd`"
chmod 755 restart-demo.sh
./restart-demo.sh ${branch}
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod 755 post-receive
</code></pre></div></div>

<p>æœåŠ¡å™¨æ‹‰å–é¡¹ç›®</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir /usr/local/gitRepo/demo
cd /usr/local/gitRepo/
git init demo
cd demo
git config --local user.name "xc"
git config --local user.email '1960481101@qq.com'
ssh-keygen -t rsa
</code></pre></div></div>

<p>æ‰¾åˆ°ç”Ÿæˆçš„æ–‡ä»¶çš„å…¬é’¥/home/git/.ssh/id_rsa.pubï¼Œæ·»åŠ åˆ° /home/git/.ssh/authorized_keys,ç„¶åå…‹éš†é¡¹ç›®</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /usr/local/gitRepo/demo
git remote add origin git@127.0.0.1:/usr/local/gitRepo/demo.git
git pull
</code></pre></div></div>

<p>é¡¹ç›®ä¸­åˆ›å»ºè„šæœ¬  restart-demo.sh</p>

<p>è„šæœ¬åœ¨é¡¹ç›®æœ€å¤–ä¾§ï¼Œæ–¹ä¾¿,mvnä½ç½®è‡ªå·±æ”¹</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#! /bin/bash
date

updateBranch=master

branch=$1
if [ "$branch" ! = "$updateBranch" ]; then
  echo "åˆ†æ”¯ä¸º${updateBranch}æ‰è¿›è¡Œæ›´æ–°"
  exit 1
fi

repoPath=$(pwd)
profile=$branch
cd $repoPath
git reset --hard origin/$branch
git checkout -f -b cache origin/$branch
git branch -D $branch
git checkout -f -b $branch origin/$branch
git branch -D cache
git pull --no-edit

/usr/local/custom/maven/bin/mvn clean package -P$profile

cd target
file=$(ls *.jar | awk '{print $1}')
sp_pid=$(ps -ef | grep $file | grep -v grep | awk '{print $2}')
if [ -z "$sp_pid" ]; then
  echo "[ not find sp-tomcat pid ]"
else
  echo "find result: $sp_pid "
  kill -9 $sp_pid
fi
logPath=$repoPath/${file%.*}.out
nohup java -jar $file &gt;$logPath 2&gt;&amp;1 &amp;
echo "--å¯åŠ¨ok,æ—¥å¿—è§$logPath--"

</code></pre></div></div>

<p>å°†é¡¹ç›®ä»£ç æ–‡ä»¶å¤¹å…¶æ‹¥æœ‰è€…è®¾ç½®ä¸ºgit</p>

<p>æ³¨æ„ï¼Œé¡¹ç›®ä¸­æ‰€æœ‰è¾“å‡ºè·¯å¾„éƒ½éœ€è¦ç”¨æˆ·gitæœ‰æ“ä½œæƒé™</p>

  </div>

  <a class="u-url" href="/2022/10/14/Linux-CentOS-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html" hidden></a>

  <div class="previous-next"><div class="previous-post">
        ğŸ‘ˆğŸ»:<a href="/2022/10/12/Linux-CentOS-redis%E5%AE%89%E8%A3%85.html">Linux Centos Rediså®‰è£…</a>
      </div><div class="next-post">
        <a href="/2023/09/06/Linux-CentOS-%E5%A6%82%E4%BD%95%E6%B3%A8%E5%86%8C%E8%87%AA%E5%B7%B1%E7%9A%84%E6%9C%8D%E5%8A%A1.html">Linux Centos å¦‚ä½•æ³¨å†Œè‡ªå·±çš„æœåŠ¡</a>:ğŸ‘‰ğŸ»
      </div></div>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">å°_å±®ã€çš„åšå®¢æ—¥è®°</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Googleé‚®ç®±,ä¸€èˆ¬ä¸çœ‹</li>
          <li><a class="u-email" href="mailto:xunderlinec1960@gmail.com">xunderlinec1960@gmail.com</a></li>
        </ul>
      </div>
      
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">QQé‚®ç®±ï¼Œæœ‰äº‹å‘è¿™é‡Œ</li>
          <li><a class="u-email" href="mailto:1960481101@qq.com">1960481101@qq.com</a></li>
        </ul>
      </div>
      
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">githubåŸºæœ¬æ²¡åœ¨ç”¨</li>
          <li><a href="https://github.com/XD3-BB"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">XD3-BB</span></a></li>
        </ul>
      </div>
    </div>

      <div class="footer-col footer-col-3">
        <span class="p-name">WordPressæ”¶è´¹ï¼ŒGhoståˆå¤ªå¤§äº†ï¼Œ2æ ¸2Gçš„æœåŠ¡å™¨è·‘ä¸èµ·æ¥ã€‚ã€‚è¿˜å¾—æ˜¯jekyllğŸ¥°</span>
      </div>
  </div>

</footer>
</body>

</html>
